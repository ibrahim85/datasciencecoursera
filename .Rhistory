#Correlations show that best predictors for Survival are Sex, PClass, Fare, Embarked
#Sex and Pclass are strongest. Fare is very highly correlated with Pclass.
#Maybe use Embarked, but it seems weird to matter in and of itself.
#Evaluate percentage of train set correct
model <- glm("Survived~Sex+Pclass",family=binomial,data=train)
train <- mutate(train,rawLogit=predict(model))
train <- mutate(train,prob=1/(1+exp(-train$rawLogit)))
train <- mutate(train,projSurvived=ifelse(train$prob>.5,1,0))
train
(train$projSurvived!=3)&(train$Age<18)
(train$projSurvived!=3)
(train$Pclass!=3)
(train$Age<18)
model <- glm("Survived~Pclass+SibSp+Parch",family=binomial,data=rawTrain)
summary(model)
summary(glm("Survived~Pclass+Parch",family=binomial,data=rawTrain))
summary(glm("Survived~SibSp+Parch",family=binomial,data=rawTrain))
summary(glm("Age~SibSp+Parch",data=rawTrain))
summary(glm("Age~SibSp+Parch+Pclass",data=rawTrain))
mutate(rawTrain,projAge=predict(model))
model <- glm("Age~SibSp+Parch+Pclass",data=rawTrain)
mutate(rawTrain,projAge=predict(model))
model <- glm("Age~SibSp+Parch+Pclass",data=rawTrain)
mutate(rawTrain,projAge=predict(model))
str(rawTrain)
sum(is.na(rawTrain))
sum(is.na(rawTrain$Age))
sum(is.na(rawTrain$Survived))
sum(is.na(rawTrain$Pclass))
sum(is.na(rawTrain$Parch))
sum(is.na(rawTrain$SibSp))
model <- glm("Age~SibSp+Parch+Pclass",data=rawTrain)
mutate(rawTrain,projAge=predict(model))
rawTrain <- read.csv("~/Kaggle/Titanic/train.csv")
rawTest <- read.csv("~/Kaggle/Titanic/test.csv")
train <- cleanTitanicFrame(rawTrain)
test <- cleanTitanicFrame(rawTest)
model <- glm("Age~SibSp+Parch+Pclass",data=rawTrain)
mutate(rawTrain,projAge=predict(model))
predict(model)
rawTrain
mutate(rawTrain,projAge=predict(model))
model
cbind(predict(model),rawTrain$Age)
length(predict(model))
predict(model)
predict(model,data=rawTrain)
length(predict(model))
length(predict(model,data=rawTrain))
model <- glm("Age~SibSp+Parch+Pclass",data=rawTrain)
length(predict(model,data=rawTrain))
model
coef(model)
coef(model)[0]
coef(model)[1]
source('~/Kaggle/Titanic/LinearModel.R')
rawTrain <- read.csv("~/Kaggle/Titanic/train.csv")
rawTest <- read.csv("~/Kaggle/Titanic/test.csv")
train <- cleanTitanicFrame(rawTrain)
test <- cleanTitanicFrame(rawTest)
train
source('~/Kaggle/Titanic/LinearModel.R')
rawTrain <- read.csv("~/Kaggle/Titanic/train.csv")
rawTest <- read.csv("~/Kaggle/Titanic/test.csv")
train <- cleanTitanicFrame(rawTrain)
test <- cleanTitanicFrame(rawTest)
train
sum(train$Survived[is.na(train$Age)])
sum(train$Survived[is.na(train$Age)])/length(train$Survived[is.na(train$Age))
sum(train$Survived[is.na(train$Age)])/length(train$Survived[is.na(train$Age)])
sum(train$Survived[is.na(train$Age)&(train$Pclass==3)])/length(train$Survived[is.na(train$Age)&(train$Pclass==3)])
sum(train$Survived[is.na(train$Age)&(train$Pclass==1)])/length(train$Survived[is.na(train$Age)&(train$Pclass==1)])
sum(train$Survived[is.na(train$Age)&(train$Pclass==2)])/length(train$Survived[is.na(train$Age)&(train$Pclass==2)])
sum(train$Survived[is.na(train$Age)&(train$Pclass==3)])/length(train$Survived[is.na(train$Age)&(train$Pclass==3)])
source('~/Kaggle/Titanic/LinearModel.R')
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
sum(train$Survived[is.na(train$Age)&(train$Pclass==3)])/length(train$Survived[is.na(train$Age)&(train$Pclass==3)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)])
length(train$Survived[is.na(train$Age)&(train$Pclass==3)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)])
rawTrain <- read.csv("~/Kaggle/Titanic/train.csv")
rawTest <- read.csv("~/Kaggle/Titanic/test.csv")
train <- cleanTitanicFrame(rawTrain)
test <- cleanTitanicFrame(rawTest)
#Correlations show that best predictors for Survival are Sex, PClass, Fare, Embarked
#Sex and Pclass are strongest. Fare is very highly correlated with Pclass.
#Maybe use Embarked, but it seems weird to matter in and of itself.
#Evaluate percentage of train set correct
model <- glm("Survived~Sex+Pclass",family=binomial,data=train)
train <- mutate(train,rawLogit=predict(model))
train <- mutate(train,prob=1/(1+exp(-train$rawLogit)))
train <- mutate(train,projSurvived=ifelse(train$prob>.5,1,0))
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)&(train$projSurvived==0)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)&(train$projSurvived==1)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)&(train$projSurvived==0)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)&(train$projSurvived==1)])
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
plot(train$Survived[is.na(train$Age)&(train$Pclass==3)&(train$projSurvived==1)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==1)&(train$projSurvived==1)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==1)&(train$projSurvived==0)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==1)&(train$projSurvived==1)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==2)&(train$projSurvived==1)])
plot(train$Survived[is.na(train$Age)&(train$Pclass==2)&(train$projSurvived==0)])
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
plot(rawTrain[rawTrain$Pclass==3,]$Survived,rawTrain[rawTrain$Pclass==3,]$Age)
plot(rawTrain[rawTrain$Pclass==1,]$Survived,rawTrain[rawTrain$Pclass==1,]$Age)
plot(rawTrain[rawTrain$Pclass==2,]$Survived,rawTrain[rawTrain$Pclass==2,]$Age)
plot(rawTrain[rawTrain$Pclass==1,]$Survived,rawTrain[rawTrain$Pclass==1,]$Age)
plot(rawTrain[rawTrain$Pclass==2,]$Survived,rawTrain[rawTrain$Pclass==2,]$Age)
plot(rawTrain[rawTrain$Pclass==3,]$Survived,rawTrain[rawTrain$Pclass==3,]$Age)
plot(rawTrain[rawTrain$Pclass==1,]$Survived,rawTrain[rawTrain$Pclass==1,]$Age)
plot(rawTrain[rawTrain$Pclass==2,]$Survived,rawTrain[rawTrain$Pclass==2,]$Age)
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
train
getCorrelations(train,"Sex")
getCorrelations(train,"Parch")
getCorrelations(train,"Survived")
rawTrain <- read.csv("~/Kaggle/Titanic/train.csv")
rawTest <- read.csv("~/Kaggle/Titanic/test.csv")
train <- cleanTitanicFrame(rawTrain)
test <- cleanTitanicFrame(rawTest)
getCorrelations(train,"Survived")
getCorrelations(train[train$Sex==1,],"Survived")
getCorrelations(train[train$Sex==1,],"Survived")
getCorrelations(train[train$Sex==2,],"Survived")
getCorrelations(train[train$Pclass==1,],"Survived")
getCorrelations(train[train$Pclass==2,],"Survived")
getCorrelations(train[train$Pclass==3,],"Survived")
getCorrelations(train[train$Parch==0,],"Survived")
str(train)
getCorrelations(train[train$Parch==0,],"Survived")
getCorrelations(train[train$Parch==1,],"Survived")
getCorrelations(train[train$Parch==2,],"Survived")
getCorrelations(train[train$Parch==3,],"Survived")
getCorrelations(train[train$Parch==4,],"Survived")
sum(train$Parch[train$Parch==3])
sum(train$Parch[train$Parch==2])
sum(train$Parch[train$Parch==1])
sum(train$Parch[train$Parch==0])
getCorrelations(train[train$Parch==0,],"Survived")
getCorrelations(train[train$Parch==1,],"Survived")
getCorrelations(train[train$Parch==2,],"Survived")
plot(train$Survived[train$Parch==2],train$SibSp[train$Parch==2])
plot(train$Survived[train$Parch==2],train$SibSp[train$Parch==2],alpha=.2)
plot(train$Survived[train$Parch==2],train$SibSp[train$Parch==2])
plot(train$Survived[train$Parch==1],train$SibSp[train$Parch==1])
plot(train$Survived[train$Parch==2],train$SibSp[train$Parch==2])
hist(train$SibSp[(train$Parch==2)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==0)])
source('~/Kaggle/Titanic/LinearModel.R')
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
hist(train$SibSp[(train$Parch==2)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==1)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==2)&(train$Survived==1)])
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
getCorrelations(train[train$Parch==0,],"Survived")
getCorrelations(train[train$Parch==1,],"Survived")
getCorrelations(train[train$Parch==2,],"Survived")
hist(train$SibSp[(train$Parch==3)&(train$Survived==0)])
hist(train$SibSp[(train$Parch==3)&(train$Survived==1)])
hist(train$SibSp[(train$Parch==3)&(train$Survived==0)])
str(train)
getCorrelations(train[train$Age<5,],"Survived")
getCorrelations(train[train$Age<10,],"Survived")
getCorrelations(train[train$Age<20,],"Survived")
getCorrelations(train[train$Age>20,],"Survived")
getCorrelations(train[train$Age>10,],"Survived")
getCorrelations(train[train$Age>30,],"Survived")
getCorrelations(train[train$Age>4
0,],"Survived")
getCorrelations(train[train$Age>40,],"Survived")
getCorrelations(train[train$Age>50,],"Survived")
getCorrelations(train[train$Age>60,],"Survived")
getCorrelations(train[train$Age<10,],"Survived")
getCorrelations(train[train$Age<20,],"Survived")
hist(train$SibSp[(train$Age<20)&(train$Survived==0)])
hist(train$SibSp[(train$Age<10)&(train$Survived==0)])
hist(train$SibSp[(train$Age<10)&(train$Survived==1)])
hist(train$SibSp[(train$Age<10)&(train$Survived==0)])
hist(train$SibSp[(train$Age<10)&(train$Survived==1)])
hist(train$SibSp[(train$Age<10)&(train$Survived==0)])
hist(train$SibSp[(train$Age<15)&(train$Survived==0)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)])
hist(train$SibSp[(train$Age<10)&(train$Survived==1)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)&(train$Pclass==3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)&(train$Pclass==2)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)&(train$Pclass==1)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)&(train$Pclass!=3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==0)&(train$Pclass!=3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)&(train$Pclass!=3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==0)&(train$Pclass!=3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==0)&(train$Pclass==3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)&(train$Pclass==3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==0)&(train$Pclass==3)])
hist(train$SibSp[(train$Age<15)&(train$Survived==1)&(train$Pclass==3)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==1)&(train$Pclass==3)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==0)&(train$Pclass==3)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==1)&(train$Pclass==3)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==0)&(train$Pclass==3)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==0)&(train$Pclass==3)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==1)&(train$Pclass==3)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==1)&(train$Pclass==3)&(train$Age<15)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==0)&(train$Pclass==3)&(train$Age<15)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==1)&(train$Pclass==3)&(train$Age<15)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==1)&(train$Pclass==3)&(train$Age<20)])
hist(train$SibSp[(train$Parch>0)&(train$Survived==1)&(train$Pclass==3)])
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
hist(train$Survived[(train$Parch>0)&(train$SibSp>0)&(train$Pclass==3)])
hist(train$Survived[(train$SibSp>0)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>0)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Age<18)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Age<15)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Age<10)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>0)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>0)&(train$Pclass==3)])
hist(train$Survived[(train$SibSp>0)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>0)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>2)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>3)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>2)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>1)&(train$Pclass==3)])
hist(train$Survived[(train$Parch>0)&(train$SibSp>2)&(train$Pclass==3)])
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
train
?rpart
names(train)
rpart("Survived~Age+Sex+Pclass+SibSp+Parch",data=train)
?rpart
rpart("Survived~Age+Sex+Pclass+SibSp+Parch",data=train)
install.packages("rpart")
install.packages("rpart")
library(rpart)
rpart("Survived~Age+Sex+Pclass+SibSp+Parch",data=train)
fit <- rpart("Survived~Age+Sex+Pclass+Sib")
fit <- rpart("Survived~Age+Sex+Pclass+SibSp+Parch",data=train)
printcp(fot)
printcp(fit)
print(fit)
plot(fit)
text(fit)
fit <- rpart("Survived~Sex+Pclass+SibSp+Parch",data=train)
plot(fit)
text(fit)
fit <- rpart("Survived~Sex+Pclass+SibSp+Age",data=train)
plot(fit)
text(fit)
print(fit)
names(train)
fit <- rpart("Survived~Sex+Pclass+SibSp+Age+Embarked",data=train)
print(fit)
plot(fit)
text(fit)
fit <- rpart("Survived~Sex+Pclass+SibSp+Age",data=train)
plot(fit)
text(fit)
fit <- rpart("Survived~Sex+Pclass+SibSp+Age",data=train,method="class")
plot(fit)
text(fit)
fit2 <- rpart("Survived~Sex+Pclass+SibSp+Age",data=train,method="exp")
fit2 <- rpart("Survived~Sex+Pclass+SibSp+Age",data=train)
plot(fit2)
text(fit2)
text(fit)
plot(fit2)
text(fit2)
par(mfrow=c(1,2))
plot(fit2)
text(fit2)
plot(fit)
text(fit)
par(mfrow=c(1,1))
?rpart
source('~/Kaggle/Titanic/LinearModel.R')
?update
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + PClass)
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
summary(model2)
summary(model1)
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + PClass)
model3 <- update(model2, . ~ . + Fare)
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
summary(model3)
anova(model1)
anova(model2)
anova(model3)
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
anova(model1,model2,model3,test="F")
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
anova(model1,model2,model3,test="LR")
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
model4 <- update(model2, . ~ . + Age)
anova(model1,model2,model3,model4,test="LR")
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
model4 <- update(model3, . ~ . + Age)
anova(model1,model2,model3,model4,test="LR")
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
model4 <- update(model2, . ~ . + projAge)
anova(model1,model2,model3,model4,test="LR")
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
#model3 <- update(model2, . ~ . + Fare)
model4 <- update(model2, . ~ . + projAge)
anova(model1,model2,model4,test="LR")
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
anova(model1,model2,model3,test="LR")
model1 <- glm("Survived~Sex",family=binomial,data=train)
model2 <- update(model1, . ~ . + Pclass)
model3 <- update(model2, . ~ . + Fare)
anova(model1,model2,model3,test="LR")
cor(train$Pclass,train$Fare)
names(train)
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
tree1 <- rpart("Survived~Sex+Pclass",data=train)
plot(tree1)
text(tree1)
str(train)
str(rawTrain)
?rgb
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
str(rawTrain)
par(mar=c(5,4,4,2))
tree <- rpart("Survived~Sex+Pclass+SibSp+projAge",data=train)
trainTree <- mutate(train,rawTree=predict(tree))
trainTree
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
install.packages("randomforest")
install.packages("randomForest")
library(randomForest)
forest <- randomForest("Survived~Sex+Pclass+SibSp+projAge", data=train)
trainForest <- mutate(train,rawForest=predict(forest))
train
forest <- randomForest("Survived~Sex+Pclass+SibSp+projAge", data=train)
?randomForest
library(randomForest)
forest <- randomForest("Survived~Sex+Pclass+SibSp+projAge", data=train)
train
forest <- randomForest(Survived~Sex+Pclass+SibSp+projAge, data=train)
print(forest)
trainForest <- mutate(train,rawForest=predict(forest))
trainForest
forest <- randomForest(as.factor(Survived)~Sex+Pclass+SibSp+projAge, data=train)
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
model <- glm("Survived~Sex+Pclass+Sex*Pclass+projAge+SibSp",family=binomial(logit),data=train)
summary(model)
model <- glm(Survived~Sex+Pclass+Sex*Pclass+projAge+SibSp,family=binomial(logit),data=train)
summary(model)
model <- glm(Survived~factor(Sex)+Pclass+Sex*Pclass+projAge+SibSp,family=binomial(logit),data=train)
summary(model)
model <- glm(Survived~as.factor(Sex)+Pclass+as.factor(Sex)*Pclass+projAge+SibSp,family=binomial(logit),data=train)
summary(model)
model <- glm(Survived~Sex+Pclass+Sex*Pclass+projAge+SibSp,family=binomial(logit),data=rawTrain)
model <- glm(Survived~Sex+Pclass+Sex*Pclass+SibSp,family=binomial(logit),data=rawTrain)
summary(model)
model <- glm(Survived~Sex+Pclass+Sex*Pclass+projAge+SibSp,family=binomial(logit),data=train)
summary(model)
model <- glm(Survived~Sex+Pclass+Sex*Pclass,family=binomial(logit),data=rawTrain)
summary(model)
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
forest <- randomForest(as.factor(Survived)~Sex+Pclass+SibSp+projAge, data=train)
trainForest <- mutate(train,rawForest=predict(forest))
trainForest <- mutate(trainForest,projSurvived=ifelse(trainForest$rawForest>.5,1,0))
trainForest
forest <- randomForest(as.factor(Survived)~Sex+Pclass+SibSp+projAge, data=train)
trainForest <- mutate(train,projSurvived=predict(forest))
sum(trainForest$Survived==trainForest$projSurvived)/length(trainForest$Survived)
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
names(rawTrain)
rawTrain <- read.csv("~/Kaggle/Titanic/train.csv",stringsAsFactors = FALSE)
str(rawTrain)
?ctree
install.packages("party")
library(party)
?ctree
ctree = ctree(as.factor(Survived) ~Sex+Pclass+SibSp+projAge, data=train)
plot(ctree)
trainCTree <- mutate(train,rawTree=predict(ctree))
trainCTree
trainCTree <- mutate(train,rawTree=predict(ctree))
ctree = ctree(as.factor(Survived) ~Sex+Pclass+SibSp+projAge, data=train)
plot(ctree)
ctree = ctree(as.factor(Survived) ~Sex+Pclass+SibSp+projAge+Embarked, data=train)
plot(ctree)
ctree = ctree(as.factor(Survived) ~Sex+Pclass+SibSp+projAge+Embarked+parch, data=train)
ctree = ctree(as.factor(Survived) ~Sex+Pclass+SibSp+projAge+Embarked+Parch, data=train)
plot(ctree)
ctree = ctree(as.factor(Survived) ~Sex+Pclass+SibSp+projAge+Sex*Pclass, data=train)
plot(ctree)
ctree = ctree(as.factor(Survived) ~Sex+Pclass+SibSp+projAge, data=train)
plot(ctree)
source('~/Kaggle/Titanic/LinearModel.R')
predictTitanic()
